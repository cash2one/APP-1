<!DOCTYPE html>
<html>

	<head lang="en">
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width,initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no">
		<link href="../css/mui.min.css" rel="stylesheet" />
		<link rel="stylesheet" type="text/css" href="../css/m_common.css" />
		<link rel="stylesheet" type="text/css" href="../css/m_detail_finance.css" />
	</head>

	<body>
		<div class="mui-content">
			<div class="top">
				<img id="picture" src="../images/blank.jpg">
				<div class="top-content">
					<p class="finance-mark"><span>小标签</span><span>小标签</span><span>小标签</span></p>
					<div id="text_box" class="text-box">
						<p id="intro" class="introduction">介绍这里是产品简单介绍介绍这里是产品简单介绍介绍这里简单介绍介介绍这里是产品简单介绍介绍这里是产品简单介绍介绍这里简单介绍介介绍这里是产品简单介绍介绍这里是产品简单介绍介绍这里简单介绍介介绍这里是产品简单介绍介绍这里是产品简单介绍介绍这里简单介绍介介绍这里是产品简单介绍介绍这里是产品简单介绍介绍这里简单介绍介绍这里是产品简单介绍介绍这里是产品简单介绍介绍这里简单介绍</p>
					</div>
				</div>
			</div>
			<div class="info">
				<p><span>平台背景</span><span>民营系</span></p>
				<p><span>注册资本</span><span>1000万</span></p>
				<p><span>上线时间</span><span>2017-01-12</span></p>
				<p><span>是否银行存管</span><span>是</span></p>
				<p><span>ICP号</span><span>12345678</span></p>
			</div>
			<div class="taste finance-table">
				<div class="table-head">
					<span>投资金融</span><span>投资期限</span><span>挖福利返现</span><span>综合年化收益</span>
				</div>
				<div class="table-list">
					<span>一万及以上</span><span>30天</span><span>投资金额*1.05%</span><span>25.00%</span>
				</div>
				<div class="table-list">
					<span>二万及以上</span><span>30天</span><span>投资金额*1.05%</span><span>25.00%</span>
				</div>
				<div class="table-list">
					<span>三万及以上</span><span>30天</span><span>投资金额*1.05%</span><span>25.00%</span>
				</div>
			</div>
			<!--体验步骤部分-->
			<div class="taste-02">
				<h3><i class="iconfont">&#xe61c;</i>投资流程</h3>
				<div id="strategy" class="detail-html"></div>
			</div>
			<div class="taste nav-contact">
				<a class="contact-qq" target="_blank" href="http://shang.qq.com/wpa/qunwpa?idkey=34f2461e64f2fb28ac36d1eab0d303760c68cdff632c46f62bd8abda313e30dc">加入QQ群</a>
				<a class="contact-qq" target="_blank" href="http://wpa.qq.com/msgrd?v=3&uin=122142551&site=qq&menu=yes">联系客服</a>
			</div>
			<div class="taste">
				<h3 class="reward"><i class="iconfont">&#xe613;</i>注意事项</h3>
				<div id="rules" class="detail-html"></div>
			</div>
			<!--立即体验部分-->
			<div class="mui-row">
				<div class="left-btn mui-col-sm-6 mui-col-xs-6">
					<button id="reg_btn" type="button" class="mui-btn mui-btn-blue mui-btn-outlined">信息登记</button>
				</div>
				<div class=" mui-col-sm-6 mui-col-xs-6">
					<button id="exp_btn" type="button" class="right mui-btn mui-btn-blue mui-btn-outlined">立即体验</button>
				</div>
			</div>

		</div>


		<script src="../js/mui.js"></script>
		<script src="../js/UserInfo.js"></script>
		<script type="text/javascript" charset="utf-8">
			mui.init();
			var id = '';
			var ismobile = false;
			var exp_url = '';
			var self = null;
			var tempview = null;
			mui.plusReady(function() {
				self = plus.webview.currentWebview();
				tempview = plus.webview.getWebviewById("temp2");
			});

			function tologin() {
				plus.nativeUI.showWaiting();
				tempview.loadURL("../a_login.html");
				tempview.addEventListener('loaded', function() {
					plus.nativeUI.closeWaiting();
					tempview.show("pop-in", 350);
				});
			}
			window.addEventListener('display', function(event) {
				//获得事件参数
				id = event.detail.id;
				img = event.detail.img;
				document.getElementById('picture').src = img;
				//根据id向服务器请求新闻详情
				var url_get_content = "http://test.wafuli.cn/app/detail/finance/";
				mui.ajax({
					url: url_get_content,
					dataType: "json",
					data: {
						token: UserInfo.token(),
						id: id,
					},
					success: function(ret) {
						if(ret.code != 0) {
							mui.alert(ret.msg);
						} else {
							var info = ret.financeinfo;
							ismobile = info.ismobile;
							document.getElementById('strategy').innerHTML = info.strategy;
							document.getElementById('rules').innerHTML = info.rules;
							if(ismobile) {
								document.getElementById('erweima_img').src = info.url;
								document.getElementById('erweima_title').src = info.title;
							} else {
								exp_url = info.url;
							}
							if(info.state == '1') {
								exp_btn.disabled = false;
							} else {
								reg_btn.disabled = true;
							}
						}

					},
					error: function(xhr, type, errorThrown) {
						mui.toast("请检查网络状况！");
					}
				});
				window.scrollTo(0, 0);
				setTimeout(function() {
					self.show();
				}, 100);
				var sss = 'share_msg.pictures=["' + img + '",];share_msg.thumbs=["' + img + '",];share_msg.href = "http://test.wafuli.cn/task/' + id + '/";';
				self.parent().evalJS(sss);
			});
			exp_btn.addEventListener('tap', function() {
				if(!UserInfo.has_login()) {
					tologin();
				} else {
					var browserMainWebview = plus.webview.getWebviewById('browser_main');
					var browserWebview = plus.webview.getWebviewById('browser_sub');
					mui.fire(browserMainWebview, 'mui.view.beforeshow');
					browserWebview.loadURL(exp_url);
					browserMainWebview.show('pop-in', 200);
				}
			});
			document.getElementById("close_01").addEventListener('tap', function() {
				document.getElementById("ding_yue").style.display = "none";
			});
			reg_btn.addEventListener('tap', function() {
				var sub_url = "m_expsubmit_finance.html";
				mui.openWindow({
					url: sub_url,
					styles: {
						top: 0,
						bottom: 0
					},
					show: {
						aniShow: 'slide-in-right',
					},
					waiting: {
						autoShow: false, //自动显示等待框
						title: '正在加载...', //等待对话框上显示的提示内容
					},
					extras: {
						sub_id: id,
					}
				});
			});

			//			联系客服
			mui('.nav-contact').on('tap', 'a', function() {
				if(UserInfo.has_login()) {
					var browserMainWebview = plus.webview.getWebviewById('browser_main');
					var browserWebview = plus.webview.getWebviewById('browser_sub');
					mui.fire(browserMainWebview, 'mui.view.beforeshow');
					browserWebview.loadURL(this.href);
					browserMainWebview.show('slide-in-right', 200);
				} else {
					tologin();
				}
			});
			var text_box = document.getElementById("text_box"),
				intro = document.getElementById("intro");
			var box_height = text_box.offsetHeight - intro.offsetHeight;
			if(box_height < 0) {
				text_box.setAttribute("class", "text-box toolong");
			}
		</script>
	</body>

</html>